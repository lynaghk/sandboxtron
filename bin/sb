#!/usr/bin/env zsh

# default to most restrictive modes
export SANDBOX_MODE_NETWORK=offline
export SANDBOX_MODE_FILE=subdir
export SANDBOX_MODE_UI=cli

while [[ $# -gt 0 ]]; do
    case "$1" in
        offline | online)
            SANDBOX_MODE_NETWORK=$1
            ;;

        subdir | most | full)
            SANDBOX_MODE_FILE=$1
            ;;

        cli | gui)
            SANDBOX_MODE_UI=$1
            ;;

        "--")
            shift
            break
            ;;

        *)
            echo "Unknown sandbox option $1" 1>&2
            exit 1
            ;;
    esac
    shift
done

exec sandbox-exec -f ~/.dotfiles/scripts/sandboxes/profile.sb \
     -D network="$SANDBOX_MODE_NETWORK"                       \
     -D file="$SANDBOX_MODE_FILE"                             \
     -D ui="$SANDBOX_MODE_UI"                                 \
     -D working-directory=`pwd`                               \
     "${@:-$SHELL}"
